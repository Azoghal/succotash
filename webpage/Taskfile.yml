version: '3'

tasks:
  default:
    cmds:
      - echo "{{.GREETING}}"
    silent: true

  # We can make this copy the relevant .env or .env.local across
  build:
    cmds:
      - mkdir -p build
      - go build -o build/server server/cmd/main.go
      - cp .env build/.env
      - task: build-webpage
  
  build-webpage:
    dir: frontend
    cmds:
      - npm run build
      - npm run package

  run:
    dir: build/
    deps:
      - build
    cmds:
      - ./server

  clean:
    cmds:
      - rm -rf build/

  pgconnect:
    cmds:
      - psql postgresql://postgres:postgres@127.0.0.1:54322/postgres